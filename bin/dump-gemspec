#!/usr/bin/env ruby

require 'pp'
require 'pry'

def dump_gemspec(compressed_content)
  inflated = Gem.inflate(compressed_content)
  unmarshalled = Marshal.load(inflated)

  [unmarshalled, unmarshalled.dependencies]
end

if !STDIN.tty?
  compressed_content = STDIN.read
elsif ARGV.count != 1
  puts "Usage: "
  puts "  dump-gemspec <file_path>"
  puts "  cat content | dump-gemspec"
  exit(1)
else
  filename = ARGV.first
  compressed_content = File.open(filename).read
end

pp dump_gemspec(compressed_content)

exit(0)
